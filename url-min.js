/*!
 * URL.js
 * 
 * Copyright 2011 Eric Ferraiuolo
 * https://github.com/ericf/urljs
 */
var URL=function(){var a=this;if(!(a&&a.hasOwnProperty&&(a instanceof URL))){a=new URL();}return a._init.apply(a,arguments);};(function(){var F="absolute",E="relative",c="http",B="https",h=":",t="//",g="@",v=".",f="/",A="..",q="../",d="?",o="=",l="&",i="#",b="",p="type",a="scheme",r="userInfo",C="host",w="port",D="path",z="query",u="fragment",y=/^(?:(https?:\/\/|\/\/)|(\/|\?|#)|[^;:@=\.\s])/i,s=/^(?:(https?)?:?\/\/)(?:([^:@\s]+:?[^:@\s]+?)@)?((?:[^;:@=\/\?\.\s]+\.)+[A-Za-z0-9\-]{2,})(?::(\d+))?(?=\/|\?|#|$)([^\?#]+)?(?:\?([^#]+))?(?:#(.+))?/i,j=/^([^\?#]+)?(?:\?([^#]+))?(?:#(.+))?/i,k="object",n="string",e=/^\s+|\s+$/g,x,m;x=String.prototype.trim?function(G){return(G&&G.trim?G.trim():G);}:function(G){try{return G.replace(e,b);}catch(H){return G;}};isObject=function(G){return(G&&typeof G===k);};m=function(G){return typeof G===n;};URL.ABSOLUTE=F;URL.RELATIVE=E;URL.normalize=function(G){return new URL(G).toString();};URL.resolve=function(H,G){return new URL(H).resolve(G).toString();};URL.prototype={_init:function(G){G=m(G)?G:G instanceof URL?G.toString():null;this._original=G;this._url={};this._isValid=this._parse(G);return this;},toString:function(){var I=this._url,M=[],J=I[p],G=I[a],L=I[D],K=I[z],H=I[u];if(J===F){M.push(G?(G+h+t):t,this.authority());if(L&&L.indexOf(f)!==0){L=f+L;}}M.push(L,K?(d+this.queryString()):b,H?(i+H):b);return M.join(b);},original:function(){return this._original;},isValid:function(){return this._isValid;},isAbsolute:function(){return this._url[p]===F;},isRelative:function(){return this._url[p]===E;},isHostRelative:function(){var G=this._url[D];return(this.isRelative()&&G&&G.indexOf(f)===0);},type:function(){return this._url[p];},scheme:function(G){return(arguments.length?this._set(a,G):this._url[a]);},userInfo:function(G){return(arguments.length?this._set(r,G):this._url[r]);},host:function(G){return(arguments.length?this._set(C,G):this._url[C]);},domain:function(){var G=this._url[C];return(G?G.split(v).slice(-2).join(v):undefined);},port:function(G){if(arguments.length){return this._set(w,G);}else{return this._url[w];}return(arguments.length?this._set(w,G):this._url[w]);},authority:function(){var I=this._url,G=I[r],J=I[C],H=I[w];return[G?(G+g):b,J,H?(h+H):b,].join(b);},path:function(G){return(arguments.length?this._set(D,G):this._url[D]);},query:function(G){return(arguments.length?this._set(z,G):this._url[z]);},queryString:function(J){if(arguments.length){return this._set(z,this._parseQuery(J));}J=b;var I=this._url[z],H,G;if(I){for(H=0,G=I.length;H<G;H++){J+=I[H].join(o);if(H<G-1){J+=l;}}}return J;},fragment:function(G){return(arguments.length?this._set(u,G):this._url[u]);},resolve:function(G){G=(G instanceof URL)?G:new URL(G);var M,O,N,L,H,I,J,K;if(!(this.isValid()&&G.isValid())){return this;}if(G.isAbsolute()){return(this.isAbsolute()?G.scheme()?G:new URL(G).scheme(this.scheme()):G);}M=new URL(this.isAbsolute()?this:null);if(G.path()){if(G.isHostRelative()||!this.path()){O=G.path();}else{O=this.path().substring(0,this.path().lastIndexOf(f)+1)+G.path();}if(O.indexOf(q)>-1){N=O.split(f);H=[];for(J=0,K=N.length;J<K;J++){L=N[J];if(L===A&&H.length>0){H.pop();}else{if(L){H.push(L);}}}I=H.join(f);if(O.indexOf(f)===0){I=f+I;}if(O.indexOf(O.length)===f){I+=f;}}else{I=O;}M.path(I).query(G.query()).fragment(G.fragment());}else{if(G.query()){M.query(G.query()).fragment(G.fragment());}else{if(G.fragment()){M.fragment(G.fragment());}}}return M;},_parse:function(H,I){H=x(H);if(!(m(H)&&H.length>0)){return false;}var J,G;if(!I){I=H.match(y);I=I?I[1]?F:I[2]?E:null:null;}switch(I){case F:J=H.match(s);if(J){G={};G[p]=F;G[a]=J[1]?J[1].toLowerCase():undefined;G[r]=J[2];G[C]=J[3].toLowerCase();G[w]=J[4]?parseInt(J[4],10):undefined;G[D]=J[5]||f;G[z]=this._parseQuery(J[6]);G[u]=J[7];}break;case E:J=H.match(j);if(J){G={};G[p]=E;G[D]=J[1];G[z]=this._parseQuery(J[2]);G[u]=J[3];}break;default:return(this._parse(H,F)||this._parse(H,E));break;}if(G){this._url=G;return true;}else{return false;}},_parseQuery:function(L){if(!m(L)){return;}L=x(L);var J=[],I=L.split(l),K,H,G;for(H=0,G=I.length;H<G;H++){if(I[H]){K=I[H].split(o);J.push(K[1]?K:[K[0]]);}}return J;},_set:function(G,H){this._url[G]=H;if(H&&(G===a||G===r||G===C||G===w)){this._url[p]=F;}if(!H&&G===C){this._url[p]=E;}this._isValid=this._parse(this.toString());return this;}};}());